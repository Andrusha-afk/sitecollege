<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π - –ö–∞—Ä—Ç–∞</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
    <header class="site-header">
        <div class="container header-content">
            <a href="index.html" class="logo">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π</a>
            <nav class="main-nav">
                <ul>
                    <li><a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
                    <li><a href="calendar.html">–ö–∞–ª–µ–Ω–¥–∞—Ä—å</a></li>
                    <li><a href="map.html" class="active">–ö–∞—Ä—Ç–∞</a></li>
                    <li><a href="create.html" class="btn-create-nav">+ –°–æ–∑–¥–∞—Ç—å</a></li>
                </ul>
            </nav>
            <div class="mobile-menu-icon">‚ò∞</div>
        </div>
    </header>

    <main class="container">
        <div class="map-page-header">
            <h1>–ö–∞—Ä—Ç–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π 2026</h1>
            <p style="color: var(--text-light)">–û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è</p>
        </div>
        
        <div class="css-map-wrapper">
            <div id="main-map" style="height: 500px; border-radius: 8px;"></div>
        </div>
        
        <div class="map-instructions">
            <p>üí° –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –º–∞—Ä–∫–µ—Ä –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.</p>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container"><p>&copy; 2026 –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π.</p></div>
    </footer>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const STORAGE_KEY = 'eventfinder_data_2026_v2';
        
        const DEFAULT_EVENTS = [
            { title: "Neon Jazz Night 2026", date: "2026-11-15", location: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ü–∞—Ä–∫", lat: 55.751244, lng: 37.618423, icon: 'üéµ', category: 'music' },
            { title: "AI Future Conf 2026", date: "2026-12-05", location: "Tech Hub Moscow", lat: 55.755814, lng: 37.617635, icon: 'üíª', category: 'tech' },
            { title: "Modern Art Expo 2026", date: "2026-11-20", location: "–ì–∞–ª–µ—Ä–µ—è –¢—Ä–µ—Ç—å—è–∫–æ–≤–∞", lat: 55.741456, lng: 37.620903, icon: 'üé®', category: 'art' }
        ];

        document.addEventListener('DOMContentLoaded', function() {
            const map = L.map('main-map').setView([55.751244, 37.618423], 11);

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(map);

            let events = [];
            try {
                const stored = localStorage.getItem(STORAGE_KEY);
                events = stored ? JSON.parse(stored) : DEFAULT_EVENTS;
            } catch (e) {
                console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–∞—Ä—Ç—ã", e);
                events = DEFAULT_EVENTS;
            }

            events.forEach(function(evt) {
                if (!evt.lat || !evt.lng) return; 

                let iconChar = 'üìç';
                if (evt.category === 'music') iconChar = 'üéµ';
                else if (evt.category === 'tech') iconChar = 'üíª';
                else if (evt.category === 'art') iconChar = 'üé®';

                const customIcon = L.divIcon({
                    className: 'custom-div-icon',
                    html: `<div style='background-color:var(--primary); color:white; width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold; box-shadow:0 2px 5px rgba(0,0,0,0.3);'>${iconChar}</div>`,
                    iconSize: [30, 30],
                    iconAnchor: [15, 15]
                });

                const marker = L.marker([evt.lat, evt.lng], {icon: customIcon}).addTo(map);
                
                let dateStr = evt.date;
                try { dateStr = new Date(evt.date).toLocaleDateString('ru-RU'); } catch(e){}

                marker.bindPopup(`
                    <strong>${evt.title || '–°–æ–±—ã—Ç–∏–µ'}</strong><br>
                    üìÖ ${dateStr}<br>
                    üìç ${evt.location || ''}<br>
                    <small>${evt.description || ''}</small>
                `);
            });
        });
    </script>
</body>
</html>